<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Admin SDIT AL-KAROMAH</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .font-arabic { font-family: 'Amiri', serif; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background: white; }
            .print-container { padding: 0 !important; margin: 0 !important; border: none !important; box-shadow: none !important; }
        }
        .print-only { display: none; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Lucide = ({ name, size = 20, className = "" }) => {
            const IconTag = lucide[name];
            return IconTag ? <IconTag size={size} className={className} /> : null;
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('dashboard');
            
            // --- DATA STATE ---
            const [students, setStudents] = useState([
                { id: 1, name: "Abdullah Ali", nis: "1001" },
                { id: 2, name: "Siti Fatimah", nis: "1002" },
                { id: 3, name: "Zaid bin Haritsah", nis: "1003" }
            ]);

            const [subjects, setSubjects] = useState([
                { id: 1, name: "Aqidah Akhlak" },
                { id: 2, name: "Bahasa Arab" },
                { id: 3, name: "Fiqih" }
            ]);

            const [attendance, setAttendance] = useState({}); 
            const [grades, setGrades] = useState({}); 
            const [journals, setJournals] = useState([]);

            // --- HELPERS ---
            const getAbsentList = (date) => {
                const dayData = attendance[date] || {};
                return students
                    .filter(s => dayData[s.id] && dayData[s.id] !== 'H')
                    .map(s => `${s.name} (${dayData[s.id]})`)
                    .join(", ") || "Hadir Semua";
            };

            const handlePrint = () => {
                window.print();
            };

            // --- COMPONENTS ---

            const Sidebar = () => (
                <aside className="w-64 bg-white border-r h-screen p-6 shrink-0 no-print">
                    <div className="flex items-center space-x-3 mb-10">
                        <div className="w-10 h-10 bg-emerald-600 rounded-xl flex items-center justify-center text-white font-black">A</div>
                        <h1 className="font-black text-xl text-slate-800">Alkaromah</h1>
                    </div>
                    <nav className="space-y-2">
                        {[
                            { id: 'dashboard', icon: 'LayoutDashboard', label: 'Dashboard' },
                            { id: 'students', icon: 'Users', label: 'Siswa & Presensi' },
                            { id: 'grades', icon: 'BookOpen', label: 'Input Nilai' },
                            { id: 'journal', icon: 'Jurnal Harian', label: 'Jurnal Harian' },
                            { id: 'report', icon: 'Printer', label: 'Rekap & Laporan' }
                        ].map(item => (
                            <button key={item.id} onClick={() => setActiveTab(item.id)}
                                className={`w-full flex items-center space-x-3 px-4 py-3 rounded-xl font-bold transition-all ${activeTab === item.id ? 'bg-emerald-600 text-white shadow-lg' : 'text-slate-500 hover:bg-emerald-50'}`}>
                                <Lucide name={item.icon === 'Jurnal Harian' ? 'FileText' : item.icon} /> <span>{item.label}</span>
                            </button>
                        ))}
                    </nav>
                </aside>
            );

            // Tampilan Laporan & Rekap
            const ReportView = () => (
                <div className="space-y-8 no-print">
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="bg-white p-8 rounded-3xl border shadow-sm hover:border-emerald-500 transition-all cursor-pointer group" onClick={handlePrint}>
                            <div className="w-12 h-12 bg-emerald-50 text-emerald-600 rounded-2xl flex items-center justify-center mb-4 group-hover:bg-emerald-600 group-hover:text-white transition-all">
                                <Lucide name="Printer" />
                            </div>
                            <h3 className="font-black text-lg">Cetak Rekap Nilai</h3>
                            <p className="text-sm text-slate-500">Cetak seluruh daftar nilai mata pelajaran siswa dalam satu lembar.</p>
                        </div>
                        <div className="bg-white p-8 rounded-3xl border shadow-sm hover:border-blue-500 transition-all cursor-pointer group" onClick={handlePrint}>
                            <div className="w-12 h-12 bg-blue-50 text-blue-600 rounded-2xl flex items-center justify-center mb-4 group-hover:bg-blue-600 group-hover:text-white transition-all">
                                <Lucide name="FileSpreadsheet" />
                            </div>
                            <h3 className="font-black text-lg">Cetak Jurnal Mengajar</h3>
                            <p className="text-sm text-slate-500">Rekap harian aktivitas guru dan catatan ketidakhadiran siswa.</p>
                        </div>
                    </div>

                    <div className="bg-amber-50 p-6 rounded-2xl border border-amber-200 flex items-start space-x-4">
                        <Lucide name="Info" className="text-amber-600 shrink-0" />
                        <p className="text-sm text-amber-800 font-medium">
                            <strong>Tips:</strong> Untuk hasil cetak terbaik, pastikan pengaturan "Background Graphics" di menu Print browser Anda sudah dicentang.
                        </p>
                    </div>
                </div>
            );

            const PrintLayout = () => (
                <div className="print-only p-10 print-container">
                    <div className="text-center border-b-4 border-double border-slate-800 pb-4 mb-8">
                        <h1 className="text-2xl font-black">SDIT AL-KAROMAH</h1>
                        <p className="text-sm font-bold uppercase">Yayasan Pondok Pesantren Al-Hidayah Bani Sya'roni</p>
                        <p className="text-xs italic">Cililin, Bandung Barat, Jawa Barat</p>
                    </div>
                    
                    <h2 className="text-center font-black underline mb-6">REKAPITULASI NILAI AKHIR SISWA</h2>
                    
                    <table className="w-full border-collapse border border-slate-800 text-xs">
                        <thead>
                            <tr className="bg-slate-100">
                                <th className="border border-slate-800 p-2">No</th>
                                <th className="border border-slate-800 p-2 text-left">Nama Siswa</th>
                                {subjects.map(s => <th key={s.id} className="border border-slate-800 p-2">{s.name}</th>)}
                            </tr>
                        </thead>
                        <tbody>
                            {students.map((s, idx) => (
                                <tr key={s.id}>
                                    <td className="border border-slate-800 p-2 text-center">{idx + 1}</td>
                                    <td className="border border-slate-800 p-2 font-bold">{s.name}</td>
                                    {subjects.map(sub => (
                                        <td key={sub.id} className="border border-slate-800 p-2 text-center">
                                            {grades[s.id]?.[sub.id] || '-'}
                                        </td>
                                    ))}
                                </tr>
                            ))}
                        </tbody>
                    </table>

                    <div className="mt-20 flex justify-end">
                        <div className="text-center w-64">
                            <p>Cililin, {new Date().toLocaleDateString('id-ID', {day:'numeric', month:'long', year:'numeric'})}</p>
                            <p className="mb-20">Wali Kelas,</p>
                            <p className="font-black underline">Risman Herdiansyah, S.Pd</p>
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="flex h-screen bg-slate-50">
                    <Sidebar />
                    <main className="flex-1 flex flex-col overflow-hidden">
                        <header className="h-20 bg-white border-b flex items-center justify-between px-10 no-print">
                            <h2 className="text-xl font-black text-slate-800 uppercase tracking-tight">ADMIN SDIT AL-KAROMAH</h2>
                            <button onClick={handlePrint} className="bg-slate-800 text-white px-5 py-2 rounded-xl text-sm font-bold flex items-center hover:bg-black transition-all">
                                <Lucide name="Printer" size={16} className="mr-2" /> Cetak Halaman
                            </button>
                        </header>
                        
                        <div className="flex-1 overflow-y-auto p-10 no-print">
                            <div className="max-w-6xl mx-auto">
                                {activeTab === 'dashboard' && (
                                    <div className="bg-white p-20 rounded-[40px] text-center border shadow-sm">
                                        <h1 className="text-6xl font-arabic text-emerald-900 mb-4">بِسْمِ اللَّهِ</h1>
                                        <p className="font-bold text-slate-500 uppercase tracking-widest">Wali Kelas: Pak Risman Herdiansyah</p>
                                    </div>
                                )}

                                {activeTab === 'students' && (
                                    <div className="bg-white p-8 rounded-3xl border shadow-sm">
                                        <h2 className="text-xl font-black mb-6 flex items-center"><Lucide name="Calendar" className="mr-2 text-emerald-600"/> Presensi Hari Ini</h2>
                                        <div className="space-y-3">
                                            {students.map(s => (
                                                <div key={s.id} className="flex items-center justify-between p-4 border rounded-2xl">
                                                    <span className="font-bold">{s.name}</span>
                                                    <div className="flex gap-2">
                                                        {['H', 'S', 'I', 'A'].map(status => (
                                                            <button key={status} onClick={() => setAttendance(prev => ({...prev, [new Date().toISOString().split('T')[0]]: {...(prev[new Date().toISOString().split('T')[0]] || {}), [s.id]: status}}))}
                                                                className={`w-10 h-10 rounded-xl font-black text-xs transition-all ${attendance[new Date().toISOString().split('T')[0]]?.[s.id] === status ? 'bg-emerald-600 text-white shadow-md' : 'bg-slate-100 text-slate-400'}`}>
                                                                {status}
                                                            </button>
                                                        ))}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {activeTab === 'grades' && (
                                    <div className="bg-white rounded-3xl border shadow-sm overflow-hidden">
                                        <div className="p-6 border-b bg-slate-50">
                                            <h3 className="font-black">Input Nilai Akhir</h3>
                                        </div>
                                        <table className="w-full">
                                            <thead>
                                                <tr className="text-left text-[10px] font-black uppercase text-slate-400 bg-slate-50">
                                                    <th className="p-4">Nama Siswa</th>
                                                    {subjects.map(sub => <th key={sub.id} className="p-4 text-center">{sub.name}</th>)}
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {students.map(s => (
                                                    <tr key={s.id} className="border-b">
                                                        <td className="p-4 font-bold">{s.name}</td>
                                                        {subjects.map(sub => (
                                                            <td key={sub.id} className="p-2">
                                                                <input type="number" value={grades[s.id]?.[sub.id] || ""} onChange={e => setGrades(prev => ({...prev, [s.id]: {...prev[s.id], [sub.id]: e.target.value}}))} className="w-16 mx-auto block p-2 border rounded-lg text-center font-bold" />
                                                            </td>
                                                        ))}
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                )}

                                {activeTab === 'journal' && (
                                    <div className="bg-white p-8 rounded-3xl border shadow-sm max-w-2xl mx-auto">
                                        <h2 className="text-xl font-black mb-6">Jurnal Mengajar</h2>
                                        <div className="space-y-4">
                                            <select className="w-full p-3 border rounded-xl font-bold">
                                                <option>Pilih Mata Pelajaran</option>
                                                {subjects.map(s => <option key={s.id}>{s.name}</option>)}
                                            </select>
                                            <textarea className="w-full p-3 border rounded-xl h-32" placeholder="Materi yang diajarkan..."></textarea>
                                            <div className="p-4 bg-red-50 text-red-700 rounded-xl border border-red-100">
                                                <p className="text-xs font-black uppercase">Siswa Tidak Hadir:</p>
                                                <p className="font-bold">{getAbsentList(new Date().toISOString().split('T')[0])}</p>
                                            </div>
                                            <button className="w-full bg-emerald-600 text-white py-4 rounded-xl font-black">Simpan Jurnal</button>
                                        </div>
                                    </div>
                                )}

                                {activeTab === 'report' && <ReportView />}
                            </div>
                        </div>

                        {/* Layout Khusus Cetak */}
                        <PrintLayout />
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
